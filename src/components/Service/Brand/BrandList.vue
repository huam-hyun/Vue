<template>
    <div>
        <!-- Header 크기 - Footer크기 -->
        <b-container fluid>
            <b-row style="height: 90px;"></b-row>
        </b-container>

        <b-container fluid>
            <b-row align-h="center">
                <b-col md="auto" style="cursor: pointer;" @click="changeSelected(item.value)" v-for="item in titles" :key="item.sector">
                    <img class="category" :src="require(`@/assets/${item.src}`)">
                    <a> {{item.title}}</a>
                </b-col>
            </b-row>
        </b-container>

        <b-container v-if="selected == 'all'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(brands), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>
            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(brands)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>
        </b-container>

        <b-container v-if="selected == 'korean'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(korean), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(korean)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'cafe'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(cafe), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(cafe)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'chicken'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(chicken), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(chicken)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'fastfood'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(fastfood), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(fastfood)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'bread'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(bread), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(bread)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'chijap'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(chijap), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(chijap)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'kimbob'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(kimbob), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(kimbob)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'hof'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(hof), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(hof)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'etc'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(etc), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(etc)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>

        <b-container v-if="selected == 'etc_f'" fluid style="height: 83vh;">
            <b-row v-for="i in 5" :key="i" align-h="center">
                <b-col cols="auto" @click="detail(item.brand_name)" class="wrapper" v-for="item in sliceitems(items(etc_f), i)" :key="item.brand_name">
                    <b-container class="brandCard">
                        {{item.brand_name}}
                    </b-container>
                </b-col>
            </b-row>

            <b-row>
                <b-col>
                    <b-pagination
                        class="pagination"
                        align="center"
                        v-model="currentPage"
                        :total-rows="rows(etc_f)"
                        :per-page="perPage"
                        first-number
                        last-number>
                    </b-pagination>
                </b-col>
            </b-row>        
        </b-container>
    </div>
</template>

<script>
import axios from 'axios'

export default {
    data(){
        return {
            perRow: 4,
            selected: null,
            brands: null,
            korean: null,
            cafe: null,
            chicken: null,
            fastfood: null,
            chijap: null,
            kimbob: null,
            hof: null,
            etc: null,
            etc_f: null,
            bread: null,
            search: '',
            perPage: 20,
            currentPage: 1,
            titles: [
                { title: '전체', value: 'all', src: 'all.png'},
                { title: '한식', value: 'korean', src: 'korean.png'},
                { title: '카페', value: 'cafe', src: 'cafe.png'},
                { title: '치킨', value: 'chicken', src: 'chicken.png'},
                { title: '패스트푸드', value: 'fastfood', src: 'fastfood.png'},
                { title: '제과제빵', value: 'bread', src: 'bread.png'},
                { title: '중/일식', value: 'chijap', src: 'chijap.png'},
                { title: '분식', value: 'kimbob', src: 'kimbob.png'},
                { title: '주점', value: 'hof', src: 'hof.png'},
                { title: '기타외식', value: 'etc', src: 'etc.png'},
                { title: '기타외국식', value: 'etc_f', src: 'etcf.png'},                
            ]
            
        }
    },
    computed:{
        rows(){
            return (sector) =>{
                return sector.length
            }
        },
        items(){
            return (sector) =>{
                const items = sector
                return items.slice(
                    (this.currentPage -1) * this.perPage,
                    this.currentPage * this.perPage
                )
            }
        },
        sliceitems(){
            return (items, index) =>{
                const list = items
                return list.slice(
                    (index-1) * this.perRow,
                    index * this.perRow
                )
            }
        }
    },
    methods: {
        detail(name){
            this.$router.push({
                name: 'BrandDetail',
                query: {name: name},
            })
        },
        searchbrand(){
            this.$router.push({
                name: 'BrandSearch',
                query: {searchparam: this.search},
            })
        },
        changeSelected(sector){
            this.currentPage = 1
            this.selected = sector
        }
    },
    created() {
        axios.get('http://34.64.236.155:8000/myapp/brand').then((res)=>{
            this.brands = res.data;
            this.korean = this.brands.filter(item => item.sector ==="한식");
            this.bread = this.brands.filter(item => item.sector === "제과제빵");
            this.cafe = this.brands.filter(item => item.sector === "카페");
            this.chicken = this.brands.filter(item => item.sector === "치킨");
            this.fastfood = this.brands.filter(item => item.sector === "패스트푸드");
            this.chijap = this.brands.filter(item => item.sector === "중/일식");
            this.kimbob = this.brands.filter(item => item.sector === "분식");
            this.hof = this.brands.filter(item => item.sector === "주점");
            this.etc = this.brands.filter(item => item.sector === "기타 외식");
            this.etc_f = this.brands.filter(item => item.sector === "기타 외국식");
            this.brands.pop()
            this.selected = 'all'
        });
        
    },
}
</script>

<style>
.category{
    height: 2vh;
}
.brandCard{
    width: 35vh;
    height: 13vh;
    display: table-cell;
    vertical-align: middle;
    background-color: beige;
    border-radius: 15px;
}
.wrapper{
    display: table; 
    margin-top: 2vh;
}

</style>